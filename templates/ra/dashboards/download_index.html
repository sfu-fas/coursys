{% extends "base-wide.html" %}
{% load static %}
{% load form_display %}

{% block title %}RA Downloads{% endblock %}
{% block h1 %}RA Downloads{% endblock %}

{% block headextra %}
<link rel="stylesheet" href="{% static 'style/ra.css' %}" />
<script nonce="{{ CSP_NONCE }}">
    $(function() {
        $("#id_start_date").datepicker({'dateFormat': 'yy-mm-dd'});
        $("#id_end_date").datepicker({'dateFormat': 'yy-mm-dd'});
        
        $(document).ready(function() {
            $('#results').dataTable({
                "bPaginate": false,
                "bJQueryUI": true,
                "aaSorting": [[1, "desc"]],
            });
        });
    });
</script>
<link rel="stylesheet" href="{% static 'style/ra.css' %}" />
{% endblock %}

{% block subbreadcrumbs %}
<li><a href="{% url "ra:advanced_search" %}">Browse Appointments</a></li>
<li>RA Downloads</li>
{% endblock %}

{% block content %}
<form action="{% url 'ra:download_index' %}" method="POST">
    {% csrf_token %}  
    {{ form.as_p }}
    <input class="submit" type="submit" value="Search" />
</form>

{% if reqs %}
<div class="datatable_container">
  <table id="reqs" class="display">
    <thead>
      <tr>
        <th scope="col">Appointee</th>
        <th scope="col">Supervisor</th>
        <th scope="col">Unit</th>
        <th scope="col">Fund</th>
        <th scope="col">Project</th>
        <th scope="col">Start Date</th>
        <th scope="col">End Date</th>
        <th scope="col">Total Pay</th>
      </tr>
    </thead>
    <tbody>
      {% for req in reqs %}
        <tr>
          <td><a href="{% url "ra:view_request" ra_slug=req.slug %}">
            {{ req.get_sort_name }}
          </a></td>
          <td>{{ req.supervisor }}</td>
          <td>{{ req.unit.label }}</td>
          <td>{{ req.get_funds }}</td>
          <td>{{ req.get_projects }}</td>
          <td><span class="sort">{{ req.start_date.isoformat }}</span>{{ req.start_date }}</td>
          <td><span class="sort">{{ req.end_date.isoformat }}</span>{{ req.end_date }}</td>
          <td>${{ req.total_pay }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="actionlist">
<a class="btn" href="{% url 'ra:download_admin' %}?start_date={{start_date}}&amp;end_date={{end_date}}">Download {{ras_count}} RAs</a>
</div>
{% endif %}
{% endblock %}